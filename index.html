<!-- javascript bitcoin simulator -->
<!doctype html>
<html>
<head>
<title>javascript bitcoin simulation</title>
<style>
.network {
  border: 1px solid #DEDEDE;
  display:block;
  margin:auto;
}

svg {
  margin: auto;
  display:block;
}

rect {
  fill: none;
  pointer-events: all;
}

.node {
  fill: #000;
}

.link {
  stroke: #999;
}
</style>
<script src="d3.v3.min.js"></script>
<script src="jquery.min.js"></script>
<script src="goog/base.js"></script>
<script>
goog.require("goog.structs.PriorityQueue")
</script>
<script src="network.js"></script> <!-- core of simulator -->
<script src="peermgr.js"></script>
<!--
<script src="peermgr.js"></script>
<script src="inventory.js"></script>
<script src="transaction.js"></script>
<script src="blockchain.js"></script>
-->
</head>
<body>
<div class="network"></div>
<script>
var btc = new Node();

btc.use(PeerMgr);

function test(node) {
	node.tick(1000, function(self) {
		if (self.id != 0)
			self.send(0, "fag", "test")
	});
}

btc.use(test);

btc.on("fag", function(self, from, obj) {
	console.log(self.now() + ": " + self.id + " received fag from " + from)

	self.delay(100, function() {
		if (Math.random() < 0.5)
			self.connect(from)
	})
})

var net = new Network(".network")
net.add(200, btc)
net.run(10000);
</script>
</body>
</html>